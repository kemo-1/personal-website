<section class="flex w-full items-start md:pl-20 pl-4 leading-[1.5] text-[clamp(1.25rem,4vw,3rem)]">
  <h2 class="sticky top-[calc(50%-0.75lh)] m-0 h-auto font-semibold leading-[1.3] bg-clip-text">
    <span aria-hidden="true">أنا متخصص&nbsp;&nbsp;&nbsp;</span>
  </h2>
  <ul class="m-0 list-none p-0 font-semibold touch-pan-y space-y-1">
    <li class="text-[#a78bfa] animate-brighten">في البرمجة.</li>
    <li class="text-[#60a5fa] animate-brighten">في التصميم.</li>
    <li class="text-[#34d399] animate-brighten">في حل المشاكل التقنية.</li>
  </ul>
</section>

<script>
  import gsap from 'gsap'
  import ScrollTrigger from 'gsap/ScrollTrigger'

  if (!CSS.supports('(animation-timeline: scroll())')) {
    gsap.registerPlugin(ScrollTrigger)
    const items = gsap.utils.toArray('li')


    gsap.set(items, {
      opacity: 0.05,
      filter: 'brightness(0.4) blur(1px)'
    })


    items.forEach((item, i) => {
      ScrollTrigger.create({
        trigger: item,
        start: 'top center',
        end: 'bottom center',
        onEnter: () => activateItem(i),
        onEnterBack: () => activateItem(i),
        scrub: true
      })
    })

    function activateItem(activeIndex) {
      items.forEach((item, i) => {
        gsap.to(item, {
          opacity: i === activeIndex ? 1 : 0.05,
          filter: i === activeIndex
            ? 'brightness(1.3) blur(0)'
            : 'brightness(0.4) blur(1px)',
          duration: 0.3,
          overwrite: 'auto'
        })
      })
    }

    document.body.style.touchAction = 'pan-y'
  }
</script>

<style is:inline>
  @keyframes brighten {
    0%, 100% {
      opacity: 0.05;
      filter: brightness(0.4) saturate(0.8) blur(1px);
      transform: scale(0.70);
    }
    50% {
      opacity: 1;
      filter: brightness(1.4) saturate(1.3) drop-shadow(0 0 12px rgba(255,255,255,0.4));
      transform: scale(1.15);
    }
  } 

  .animate-brighten {
    animation: brighten linear both;
    animation-timeline: view();
    animation-range: cover 0% 100%;
    transition: all 0.3s ease;
  }

  @media (max-width: 768px) {
    .animate-brighten {
      animation-range: cover 10% 90%;
    }
  }

  @media not supports (animation-timeline: scroll()) {
    .animate-brighten { animation: none !important; }
  }
</style>
